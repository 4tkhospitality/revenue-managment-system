const fs = require('fs');
const path = require('path');

const filePath = path.join(__dirname, '..', 'messages', 'ms.json');
const data = JSON.parse(fs.readFileSync(filePath, 'utf8'));

const msGuide = {
    "title": "Panduan Pengguna RMS",
    "subtitle": "Panduan untuk Pengurus Besar dan kakitangan pengurusan pendapatan",
    "troubleshooting": "Penyelesaian Masalah",
    "searchPlaceholder": "Cari istilah, panduan... (Ctrl+K)",
    "stat5min": "5 minit setiap pagi",
    "stat30terms": "30+ istilah",
    "stat4modules": "4 modul",
    "navQuickStart": "Mula Pantas",
    "navRevenueMgmt": "Pengurusan Pendapatan",
    "navOtaPricing": "Harga OTA",
    "navDataMgmt": "Pengurusan Data",
    "subMorning": "Rutin 5 Minit Pagi",
    "sub5Steps": "5 Langkah Bermula",
    "subGlossary": "Glosari Lengkap",
    "subFaq": "Masalah Biasa",
    "subRmIntro": "Apa itu Revenue Management?",
    "subKpi": "Kad KPI",
    "subCharts": "Carta OTB",
    "subRecTable": "Jadual Cadangan Harga",
    "subDynPricing": "Harga Dinamik",
    "subSeasons": "Musim",
    "subOccTiers": "Tahap OCC",
    "subTerms": "Istilah Industri",
    "subPricingIntro": "Gambaran Keseluruhan",
    "subFormula": "2 Formula Harga",
    "subChannels": "Saluran OTA & Komisen",
    "subPromos": "Promosi & Penindanan",
    "subCompare": "Perbandingan Antara Saluran",
    "subPriceMatrix": "Matriks Harga",
    "subReverse": "Pengiraan Terbalik (BAR → NET)",
    "subExport": "Eksport CSV",
    "subImport": "Import Data",
    "subBuildOtb": "Bina OTB",
    "subBuildFeatures": "Bina Ciri",
    "subRunForecast": "Jalankan Ramalan",
    "tsBlankPage": "Halaman kosong, tiada data",
    "tsBlankCause": "Fail PMS belum dimuat naik",
    "tsBlankFix": "Pergi ke Upload, seret & lepas fail XML/CSV dari PMS",
    "tsUploadFail": "Muat naik gagal",
    "tsUploadCause": "Format fail salah",
    "tsUploadFix": "Gunakan fail XML atau CSV yang dieksport dari PMS (Opera, RoomRaccoon, Cloudbeds)",
    "tsPickupNa": "Pickup menunjukkan \"N/A\"",
    "tsPickupCause": "Perlu sekurang-kurangnya 2 muat naik",
    "tsPickupFix": "Muat naik lagi, tunggu 7 hari untuk data pickup",
    "tsForecastEst": "Ramalan menunjukkan \"Anggaran\"",
    "tsForecastCause": "Data pickup tidak mencukupi",
    "tsForecastFix": "Terus muat naik setiap hari, ramalan tepat tersedia selepas 2 minggu",
    "tsPriceBad": "Harga terlalu tinggi / terlalu rendah",
    "tsPriceCause": "Penindanan promosi > 50%",
    "tsPriceFix": "Kurangkan bilangan promosi atau semak penggalak komisen",
    "tsSeasonWrong": "Season \"auto\" memilih musim yang salah",
    "tsSeasonCause": "Julat tarikh musim tidak betul",
    "tsSeasonFix": "Pergi ke Config Season, semak julat tarikh",
    "tsCauseLabel": "Punca",
    "tsFixLabel": "Pembaikan",
    "tsOpenLabel": "Buka",
    "paywallTitle": "Pengurusan Pendapatan",
    "paywallSubtitle": "Panduan analisis OTB, Pickup, Ramalan dan Pengurusan Pendapatan",
    "paywallF1": "Memahami OTB (On The Books) & Pickup",
    "paywallF2": "Menganalisis Kadar Tempahan & Baki Bekalan",
    "paywallF3": "Strategi harga berasaskan permintaan",
    "paywallF4": "Aliran kerja Daily Actions",
    "morningTitle": "Rutin 5 minit setiap pagi",
    "morningDesc": "Ikuti 6 langkah ini setiap pagi untuk pengurusan pendapatan yang berkesan:",
    "morningExportPms": "Eksport PMS",
    "morningUpload": "Muat Naik",
    "morningBuildData": "Bina Data",
    "morningViewDash": "Lihat Dashboard",
    "morningAcceptPrice": "Terima/Override Harga",
    "morningUpdateOta": "Kemas kini OTA",
    "morningTip": "Jumlah masa: ~5 minit. Selepas muat naik, sistem memproses data secara automatik.",
    "stepsTitle": "5 Langkah Bermula",
    "step1Title": "Log Masuk",
    "step1Desc": "Gunakan akaun Google yang diberikan oleh admin. Selepas log masuk, anda akan nampak hotel anda di sidebar.",
    "step1Tip": "Jika anda tiada akses, hubungi admin melalui Zalo: 0778602953",
    "step2Title": "Muat Naik Data dari PMS",
    "step2Desc": "Pergi ke menu <strong>Upload</strong> → Seret & lepas fail XML atau CSV dari PMS (Opera, RoomRaccoon, Cloudbeds...).",
    "step2Link": "Buka halaman Upload",
    "step2Warn": "Muat naik data setiap hari (pagi) untuk metrik paling tepat.",
    "step3Title": "Bina Data (automatik)",
    "step3Desc": "Pergi ke menu <strong>Data</strong> → Klik butang mengikut turutan:",
    "step3Link": "Buka halaman Data",
    "step4Title": "Lihat Dashboard",
    "step4Kpi": "<strong>Kad KPI:</strong> Bilik OTB, Baki Bekalan, Pickup",
    "step4Charts": "<strong>Carta:</strong> Carta OTB harian, perbandingan tahun ke tahun",
    "step4Price": "<strong>Jadual Harga:</strong> Harga cadangan untuk setiap hari",
    "step4Link": "Buka Dashboard",
    "step5Title": "Buat Keputusan Harga",
    "step5Accept": "Terima",
    "step5AcceptDesc": "Terima harga cadangan sistem",
    "step5Override": "Override",
    "step5OverrideDesc": "Masukkan harga anda sendiri",
    "glossaryTitle": "Istilah Industri",
    "glossaryTerm": "Istilah",
    "glossaryDef": "Definisi",
    "glossOtb": "On The Books — Bilik/pendapatan yang sudah ditempah",
    "glossAdr": "Average Daily Rate — Harga bilik purata",
    "glossRevpar": "Pendapatan Setiap Bilik Tersedia",
    "glossOcc": "Kadar penghunian — % bilik terjual",
    "glossPickup": "Tempahan baru dalam tempoh masa tertentu",
    "glossBar": "Best Available Rate — Harga asas OTA (sebelum promo)",
    "glossNet": "Pendapatan sebenar selepas komisen dan promosi",
    "glossDisplay": "Harga yang tetamu lihat di OTA (selepas promo)",
    "glossStly": "Same Time Last Year — Perbandingan tahun ke tahun",
    "glossPace": "Kadar tempahan — berbanding tempoh sama",
    "glossRemaining": "Bilangan bilik tersedia untuk dijual",
    "glossCommission": "Komisen OTA (cth. Agoda 20%, Booking 18%)",
    "glossStacking": "Menggabungkan pelbagai promo (aditif / progresif / pilih satu)",
    "faqTitle": "Masalah Biasa & FAQ",
    "faqDqTitle": "Kualiti Data: ada amaran?",
    "faqDqWarnings": "Kebanyakan amaran ialah <code>PAST_STAY_DATE</code> — data mempunyai tarikh penginapan yang telah lepas.",
    "faqDqClean": "Semua data sah.",
    "faqDqStats": "<strong>Hotel anda:</strong> {total} baris OTB",
    "faqDqPast": ", antaranya {past} baris telah lepas ({pct}%)",
    "faqDqCompleteness": "Kelengkapan: <strong>{pct}%</strong>.",
    "faqPickupTitle": "\"Avg Pickup: N/A\" — Mengapa tiada nombor?",
    "faqPickupDesc": "<strong>Pickup</strong> = Bandingkan tempahan hari ini dengan 7 hari lalu. Perlu sekurang-kurangnya <strong>2 muat naik ≥ 7 hari terpisah</strong>.",
    "faqForecastTitle": "Ramalan menunjukkan \"Anggaran\" — Adakah ia tepat?",
    "faqForecastDesc": "Tanpa data pickup yang mencukupi, sistem menggunakan anggaran kasar. Selepas <strong>≥ 2 muat naik ≥ 7 hari terpisah</strong>, ramalan akan berdasarkan pickup sebenar.",
    "faqUploadTitle": "Sudah muat naik tetapi data tidak muncul?",
    "faqUploadDesc": "Semak: (1) Fail dalam format XML/CSV, (2) Jalankan Build OTB → Build Features → Run Forecast, (3) Tunggu beberapa saat untuk pemprosesan.",
    "ctaReady": "Sedia? Jom mulakan!",
    "ctaUpload": "Muat Naik Data",
    "ctaViewDash": "Lihat Dashboard",
    "rmTitle": "Apa itu Revenue Management?",
    "rmDesc": "Revenue Management (RM) = <strong>menjual bilik yang betul, pada harga yang betul, pada masa yang betul</strong> untuk memaksimumkan pendapatan. Sistem membantu anda:",
    "rmMonitorOtb": "Pantau OTB",
    "rmMonitorDesc": "Berapa bilik telah ditempah, berapa yang tersedia",
    "rmForecast": "Ramalan Permintaan",
    "rmForecastDesc": "Ramalkan kadar tempahan 30–90 hari akan datang",
    "rmPriceRec": "Cadangan Harga",
    "rmPriceRecDesc": "Terima harga sistem atau Override dengan harga anda sendiri",
    "rmMonitor": "Pantau OTB",
    "rmPrice": "Cadangan Harga",
    "rmPriceDesc": "Terima harga sistem atau Override dengan harga anda",
    "kpiTitle": "Adakah jualan hari ini baik?",
    "kpiDesc": "Dashboard menunjukkan 4 kad KPI utama. Baca mengikut soalan biasa GM:",
    "kpiOtbName": "Bilik OTB",
    "kpiOtbDesc": "Bilik yang telah ditempah. Cth: OTB = 45 bermakna anda telah menjual 45 bilik untuk hari itu.",
    "kpiRemName": "Baki Bekalan",
    "kpiRemDesc": "Bilik yang masih tersedia. Cth: Baki = 15 bermakna 15 bilik lagi untuk dijual.",
    "kpiPickupName": "Pickup (7h)",
    "kpiPickupDesc": "Tempahan baru dalam 7 hari terakhir. Pickup = +8 bagus (permintaan meningkat).",
    "kpiAdrName": "ADR",
    "kpiAdrDesc": "Harga bilik purata. Cth: ADR = 1.2J bermakna purata 1.2J setiap bilik semalam.",
    "kpiLink": "Buka Dashboard untuk lihat KPI",
    "kpiOpenDash": "Buka Dashboard lihat KPI"
};

Object.assign(data.guidePage, msGuide);
fs.writeFileSync(filePath, JSON.stringify(data, null, 2) + '\n', 'utf8');
console.log(`✅ ms.json guidePage part 1: patched ${Object.keys(msGuide).length} keys`);
