{
  "updated_at": "2026-02-22T09:32:00+07:00",
  "working_on": {
    "feature": "i18n Internationalization — Completeness & Cleanup",
    "task": "Completed: Date locale fix, missing keys (dashboard + rateShopper), 3 TS errors fix, 61 scripts archived, i18n audit (2338 keys × 5 locales = 0 missing). All pushed to main (37d3533)",
    "status": "completed",
    "files": [
      "apps/web/lib/insights/insightsV2Engine.ts",
      "apps/web/components/dashboard/RecommendationTable.tsx",
      "apps/web/messages/en.json",
      "apps/web/messages/vi.json",
      "apps/web/messages/id.json",
      "apps/web/messages/ms.json",
      "apps/web/messages/th.json",
      "apps/web/app/data/BuildFeaturesButton.tsx",
      "apps/web/app/data/RunForecastButton.tsx",
      "apps/web/app/upload/page.tsx"
    ],
    "blockers": [],
    "notes": "rms.pakhos.com Vercel project did NOT auto-deploy. User needs to check Vercel Settings > Git > Production Branch or manually Redeploy."
  },
  "pending_tasks": [
    {
      "task": "Fix rms.pakhos.com Vercel deployment",
      "priority": "high",
      "notes": "Project 'revenue-managment-system' (rms.pakhos.com) not auto-deploying from main. The other project 'revenue-managment-system-1lzs' (www.pakhos.com) deployed fine. Check Vercel Git settings or Redeploy manually."
    },
    {
      "task": "Account Mapping Admin Page",
      "priority": "medium",
      "notes": "Quick fix done (Unknown → Direct/Walk-in). Need full admin page for company_name mapping."
    },
    {
      "task": "Distribution & Conversion Clinic — Channel Revenue & Risk (P0)",
      "priority": "medium",
      "notes": "Brainstorm complete. Needs: 1 API route (channel-performance) + 1 UI component."
    },
    {
      "task": "Landing Page Redesign (when ready to re-enable)",
      "priority": "low",
      "notes": "pakhos.com redirected to rms.pakhos.com via vercel.json. Remove vercel.json to restore."
    },
    {
      "task": "Editable Commission Inline per OTA",
      "priority": "medium",
      "notes": "Planned earlier. Allows hotel to override default commission % directly in pricing overview."
    }
  ],
  "recent_changes": [
    {
      "timestamp": "2026-02-22T09:22:00+07:00",
      "type": "fix",
      "description": "Fixed 3 pre-existing TypeScript errors: nullish coalescing (?? 0) for optional count params in t() calls. Files: BuildFeaturesButton.tsx, RunForecastButton.tsx, upload/page.tsx. npx tsc --noEmit → 0 errors.",
      "files": [
        "apps/web/app/data/BuildFeaturesButton.tsx",
        "apps/web/app/data/RunForecastButton.tsx",
        "apps/web/app/upload/page.tsx"
      ]
    },
    {
      "timestamp": "2026-02-22T08:43:00+07:00",
      "type": "refactor",
      "description": "Archived 61 one-time i18n migration scripts to apps/web/scripts/_archive_i18n/. Created i18n-audit.js for key parity checking. Audit result: 2338 keys × 5 locales = 0 missing.",
      "files": [
        "apps/web/scripts/_archive_i18n/",
        "apps/web/scripts/i18n-audit.js"
      ]
    },
    {
      "timestamp": "2026-02-22T08:20:00+07:00",
      "type": "fix",
      "description": "Added missing rateShopper.thCheckIn and rateShopper.thTaxFee keys to all 5 locale files. These were used in rate-shopper/page.tsx but never defined.",
      "files": [
        "apps/web/messages/en.json",
        "apps/web/messages/vi.json",
        "apps/web/messages/id.json",
        "apps/web/messages/ms.json",
        "apps/web/messages/th.json"
      ]
    },
    {
      "timestamp": "2026-02-22T01:30:00+07:00",
      "type": "fix",
      "description": "Fixed date locale formatting: insightsV2Engine.ts uses Intl.DateTimeFormat with BCP 47 locale mapping. RecommendationTable.tsx uses useLocale() for toLocaleDateString. Translated ~40 untranslated dashboard keys in id/ms/th.",
      "files": [
        "apps/web/lib/insights/insightsV2Engine.ts",
        "apps/web/components/dashboard/RecommendationTable.tsx",
        "apps/web/messages/id.json",
        "apps/web/messages/ms.json",
        "apps/web/messages/th.json"
      ]
    }
  ],
  "errors_encountered": [
    {
      "error": "MISSING_MESSAGE for rateShopper.thCheckIn and rateShopper.thTaxFee in Indonesian locale",
      "solution": "Keys were never defined in ANY locale file (including en.json). Added to all 5 locales.",
      "resolved": true
    },
    {
      "error": "Date formatting showed English day names in Vietnamese/Indonesian/etc locales",
      "solution": "Replaced hardcoded English day abbreviations with Intl.DateTimeFormat using BCP 47 locale mapping (e.g., 'vi' → 'vi-VN'). Also added useLocale() in RecommendationTable.",
      "resolved": true
    },
    {
      "error": "3 TypeScript errors: 'number | undefined' not assignable to 'string | number | Date' in t() calls",
      "solution": "Added ?? 0 nullish coalescing for optional count params: result.rowsBuilt ?? 0, result.count ?? 0",
      "resolved": true
    },
    {
      "error": "rms.pakhos.com Vercel project not auto-deploying latest commits",
      "solution": "Need to check Vercel Settings > Git > Production Branch or manually trigger Redeploy",
      "resolved": false
    }
  ],
  "decisions_made": [
    {
      "decision": "Use Intl.DateTimeFormat with BCP 47 locale mapping for date formatting",
      "reason": "More robust than hardcoded English abbreviations. Supports all 5 locales correctly."
    },
    {
      "decision": "Archive i18n migration scripts to _archive_i18n/ instead of deleting",
      "reason": "Preserves history in case scripts need to be referenced. Keeps main scripts/ folder clean."
    },
    {
      "decision": "Keep i18n-audit.js as a permanent utility script",
      "reason": "Useful for ongoing key parity checking. Can be run anytime to verify locale completeness."
    }
  ]
}